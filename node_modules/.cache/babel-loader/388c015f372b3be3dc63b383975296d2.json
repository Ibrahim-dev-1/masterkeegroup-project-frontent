{"ast":null,"code":"import _slicedToArray from \"C:\\\\Users\\\\Kratos\\\\Desktop\\\\PROJET BTS\\\\kratos_react\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"C:\\\\Users\\\\Kratos\\\\Desktop\\\\PROJET BTS\\\\kratos_react\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"C:\\\\Users\\\\Kratos\\\\Desktop\\\\PROJET BTS\\\\kratos_react\\\\src\\\\contexts\\\\divisionContext.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React from 'react';\nconst DivisionStateContext = React.createContext();\nconst DivisionDispatchContext = React.createContext(); //==================== LES FONCTIONS =====================//\n// ============= ADD DIVISION ==============================//\n\nconst addDivision = async (state, payload) => {\n  const RequestAddDivision = {\n    query: \"\\n            mutation{\\n                addDivision(input: { nom: \\\"\".concat(payload.nom, \"\\\"}){ id, nom }\\n            }\\n        \")\n  };\n  const result = await fetch('http://localhost:8000/graphql', {\n    method: \"post\",\n    body: JSON.stringify(RequestAddDivision),\n    headers: {\n      \"content-type\": \"application/json\"\n    }\n  });\n  const res = await result.json();\n  return console.log(res);\n}; // =============================================//\n//                 REDUCER\n//==============================================//\n\n\nconst rootReducer = (state, action) => {\n  switch (action.type) {\n    case \"ADD_DIVISION\":\n      return addDivision(state, action.payload);\n    // case \"DELETE_DIVISION\":\n    //    return deleteDivision();\n\n    case \"GET_DIVISIONS\":\n      return _objectSpread({}, state, {\n        divisions: action.payload\n      });\n    // case \"UPDATE_DIVISION\":\n    // return updateDivision();\n\n    default:\n      return state;\n  }\n}; // =============================================//\n//                 PROVIDER\n//==============================================//\n\n\nconst DivisionProvider = props => {\n  const _React$useReducer = React.useReducer(rootReducer, {\n    isLoading: false\n  }),\n        _React$useReducer2 = _slicedToArray(_React$useReducer, 2),\n        state = _React$useReducer2[0],\n        dispatch = _React$useReducer2[1];\n\n  return React.createElement(DivisionStateContext.Provider, {\n    value: state,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62\n    },\n    __self: this\n  }, React.createElement(DivisionDispatchContext.Provider, {\n    value: dispatch,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63\n    },\n    __self: this\n  }, props.children));\n}; // =============================================//\n//                 le consummer du state\n//==============================================//\n\n\nconst useDivisionState = () => {\n  const context = React.useContext(DivisionStateContext);\n\n  if (context === undefined) {\n    throw new Error(\" le State doit s'uitliser dans le provider \");\n  }\n\n  return context;\n}; // =============================================//\n//                 le consummer du reducer\n//==============================================//\n\n\nconst useDispatchContext = () => {\n  const context = React.useContext(DivisionDispatchContext);\n\n  if (context === undefined) {\n    throw new Error(\" la fonction dispatch doit s'utiliser dans le provider \");\n  }\n\n  return context;\n};\n\nconst getDivision = async (dispatch, token) => {\n  const requestBody = {\n    query: \"\\n            query {\\n                divisions{\\n                    id \\n                    nom\\n                }\\n            }\\n        \"\n  };\n  const result = await fetch('http://localhost:8000/graphql', {\n    method: \"POST\",\n    body: JSON.stringify(requestBody),\n    headers: {\n      \"content-type\": \"application/json\",\n      'Authorization': 'Kratos ' + token\n    }\n  });\n\n  if (result.status !== 200 || result.status !== 201) {\n    console.log(res);\n    throw new Error(\"Error :  impossible de fetch les donnés depuis l'api backend de notre application \");\n  }\n\n  const _ref = await result.json(),\n        data = _ref.data;\n\n  console.log(data.divisions);\n  dispatch({\n    type: \"GET_DIVISIONS\",\n    payload: data.divisions\n  });\n};\n\nexport { useDivisionState, useDispatchContext, DivisionProvider, getDivision };","map":{"version":3,"sources":["C:\\Users\\Kratos\\Desktop\\PROJET BTS\\kratos_react\\src\\contexts\\divisionContext.js"],"names":["React","DivisionStateContext","createContext","DivisionDispatchContext","addDivision","state","payload","RequestAddDivision","query","nom","result","fetch","method","body","JSON","stringify","headers","res","json","console","log","rootReducer","action","type","divisions","DivisionProvider","props","useReducer","isLoading","dispatch","children","useDivisionState","context","useContext","undefined","Error","useDispatchContext","getDivision","token","requestBody","status","data"],"mappings":"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","sourcesContent":["import React from 'react';\r\n\r\n\r\nconst DivisionStateContext = React.createContext();\r\nconst DivisionDispatchContext = React.createContext();\r\n\r\n\r\n\r\n//==================== LES FONCTIONS =====================//\r\n\r\n// ============= ADD DIVISION ==============================//\r\nconst addDivision = async (state, payload) => {\r\n    const RequestAddDivision = {\r\n        query: `\r\n            mutation{\r\n                addDivision(input: { nom: \"${payload.nom}\"}){ id, nom }\r\n            }\r\n        `\r\n    }\r\n\r\n    const result = await fetch('http://localhost:8000/graphql',{\r\n        method: \"post\",\r\n        body: JSON.stringify(RequestAddDivision),\r\n        headers: {\r\n            \"content-type\" : \"application/json\"\r\n        }\r\n    })\r\n\r\n    const res = await result.json();\r\n    return console.log(res);\r\n}\r\n\r\n\r\n\r\n\r\n\r\n// =============================================//\r\n//                 REDUCER\r\n//==============================================//\r\nconst rootReducer = (state, action) => {\r\n    switch (action.type) {\r\n        case \"ADD_DIVISION\":\r\n           return addDivision(state,action.payload);\r\n       // case \"DELETE_DIVISION\":\r\n        //    return deleteDivision();\r\n        case \"GET_DIVISIONS\":\r\n            return {...state, divisions: action.payload}\r\n        \r\n           // case \"UPDATE_DIVISION\":\r\n           // return updateDivision();\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\n// =============================================//\r\n//                 PROVIDER\r\n//==============================================//\r\nconst DivisionProvider = (props) => {\r\n\r\n    const [ state, dispatch ] = React.useReducer(rootReducer, {isLoading: false });\r\n    return <DivisionStateContext.Provider value={ state } >\r\n            <DivisionDispatchContext.Provider value={dispatch}>\r\n                { props.children }\r\n            </DivisionDispatchContext.Provider>\r\n    </DivisionStateContext.Provider>\r\n}\r\n\r\n// =============================================//\r\n//                 le consummer du state\r\n//==============================================//\r\nconst useDivisionState = () => {\r\n   const context = React.useContext(DivisionStateContext);\r\n   if(context === undefined)\r\n   {\r\n      throw new Error( \" le State doit s'uitliser dans le provider \")\r\n   }\r\n   return  context;\r\n}\r\n\r\n// =============================================//\r\n//                 le consummer du reducer\r\n//==============================================//\r\nconst useDispatchContext = () => {\r\n    const context = React.useContext(DivisionDispatchContext);\r\n    if(context === undefined)\r\n    {\r\n        throw new Error(\" la fonction dispatch doit s'utiliser dans le provider \")\r\n    }\r\n \r\n    return context;\r\n }\r\n\r\n const getDivision = async (dispatch, token ) => {\r\n    const requestBody = {\r\n        query: `\r\n            query {\r\n                divisions{\r\n                    id \r\n                    nom\r\n                }\r\n            }\r\n        `\r\n    }\r\n\r\n    const result = await fetch('http://localhost:8000/graphql', {\r\n        method: \"POST\",\r\n        body: JSON.stringify(requestBody),\r\n        headers: {\r\n            \"content-type\": \"application/json\",\r\n            'Authorization': 'Kratos ' + token\r\n        }\r\n    })\r\n\r\n    if(result.status !== 200 || result.status !== 201){\r\n        console.log(res)\r\n        throw new Error(\"Error :  impossible de fetch les donnés depuis l'api backend de notre application \")\r\n    }\r\n\r\n    const { data } = await result.json();\r\n    console.log(data.divisions)\r\n    dispatch({type: \"GET_DIVISIONS\" , payload: data.divisions })\r\n }\r\n\r\n\r\n export  {\r\n    useDivisionState,\r\n    useDispatchContext,\r\n    DivisionProvider,\r\n    getDivision,\r\n };"]},"metadata":{},"sourceType":"module"}