{"ast":null,"code":"import _slicedToArray from \"C:\\\\Users\\\\Kratos\\\\Desktop\\\\PROJET BTS\\\\kratos_react\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"C:\\\\Users\\\\Kratos\\\\Desktop\\\\PROJET BTS\\\\kratos_react\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"C:\\\\Users\\\\Kratos\\\\Desktop\\\\PROJET BTS\\\\kratos_react\\\\src\\\\contexts\\\\loginContext.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React from 'react';\nconst loginStateContext = React.useContext();\nconst loginDispatchContext = React.useContext(); // =============================================//\n//                 Root Reducer\n//==============================================//\n\nconst rootReducer = (state, action) => {\n  switch (action.type) {\n    case \"LOGIN\":\n      return _objectSpread({}, state, {\n        login: action.payload\n      });\n\n    case \"LOGOUT\":\n      return _objectSpread({}, state, {\n        login: action.payload\n      });\n\n    default:\n      console.log(\"ce type d'action n'est pas reconnu . veuillez entrez une action correcte : ACTION ERROR: \" + action.type);\n      return state;\n  }\n}; // =============================================//\n//                 PROVIDER\n//==============================================//\n\n\nconst LoginProvider = ({\n  children\n}) => {\n  const _React$useReducer = React.useReducer(rootReducer, {\n    login: {}\n  }),\n        _React$useReducer2 = _slicedToArray(_React$useReducer, 2),\n        state = _React$useReducer2[0],\n        dispatch = _React$useReducer2[1];\n\n  return React.createElement(loginStateContext.Provider, {\n    value: state,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 31\n    },\n    __self: this\n  }, React.createElement(loginDispatchContext.Provider, {\n    value: dispatch,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 32\n    },\n    __self: this\n  }, children));\n}; // =============================================//\n//                 useLoginState\n//==============================================//\n\n\nconst useLoginState = () => {\n  // recuperation de notre state grace au consumer\n  const context = React.useContext(loginStateContext);\n  if (context === undefined) throw new Error(\"le State doit s'utiliser dans un provider\");\n  return context;\n}; // =============================================//\n//                 useLoginDispatchState\n//==============================================//\n\n\nconst useLoginDispatchState = () => {\n  // recuperation de notre fonction dispatch grace au consumer\n  const context = React.useContext(loginDispatchContext);\n  if (context === undefined) throw new Error(\" la fonction dispatch doit s'utilsier dans le provider\");\n  return context;\n}; // =============================================//\n//                 Order fonctions\n//==============================================//\n// LOGIN FONCTION IMPLEMENTATION\n\n\nconst login = async (dispatch, myState) => {\n  const requestBody = {\n    query: \"\\n            query{\\n                login(email: , password: ){ userId email admin token tokenExpiration }\\n            }\\n        \"\n  };\n  const results = await fetch('http://localhost:8000/graphql', {\n    method: \"POST\",\n    body: JSON.stringify(requestBody),\n    headers: {\n      'Content-type': 'application/json'\n    }\n  });\n\n  if (results.status !== 201 && results.status !== 200) {\n    throw new Error(\"erreur de Login ...\" + results.statusText);\n  }\n\n  const _ref = await results.json(),\n        data = _ref.data;\n\n  dispatch({\n    type: \"LOGIN\",\n    payload: data.login\n  });\n};\n\nconst logout = dispatch => {\n  dispatch({\n    type: \"LOGOUT \",\n    payload: {\n      token: '',\n      userId: '',\n      userEmail: '',\n      tokenExpiration: ''\n    }\n  });\n}; // =============================================//\n//                MODULES iMPORTS               //\n\n\nexport { useLoginDispatchState, useLoginState, LoginProvider, login, logout };","map":{"version":3,"sources":["C:\\Users\\Kratos\\Desktop\\PROJET BTS\\kratos_react\\src\\contexts\\loginContext.js"],"names":["React","loginStateContext","useContext","loginDispatchContext","rootReducer","state","action","type","login","payload","console","log","LoginProvider","children","useReducer","dispatch","useLoginState","context","undefined","Error","useLoginDispatchState","myState","requestBody","query","results","fetch","method","body","JSON","stringify","headers","status","statusText","json","data","logout","token","userId","userEmail","tokenExpiration"],"mappings":"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","sourcesContent":["import React from 'react';\r\n\r\nconst loginStateContext = React.useContext();\r\nconst loginDispatchContext = React.useContext();\r\n\r\n\r\n\r\n// =============================================//\r\n//                 Root Reducer\r\n//==============================================//\r\nconst rootReducer = (state, action) => {\r\n    switch(action.type){\r\n        case \"LOGIN\":\r\n            return {...state , login: action.payload}\r\n        case \"LOGOUT\":\r\n            return {...state , login: action.payload}\r\n        default:\r\n            console.log(\"ce type d'action n'est pas reconnu . veuillez entrez une action correcte : ACTION ERROR: \" + action.type );\r\n            return state;\r\n    }\r\n}\r\n\r\n// =============================================//\r\n//                 PROVIDER\r\n//==============================================//\r\nconst LoginProvider = ({children}) => {\r\n    const [state, dispatch] = React.useReducer(rootReducer, {\r\n        login:{}\r\n    })\r\n\r\n    return <loginStateContext.Provider value={state}>\r\n        <loginDispatchContext.Provider value={dispatch}>\r\n            {children}\r\n        </loginDispatchContext.Provider>\r\n    </loginStateContext.Provider>\r\n}\r\n// =============================================//\r\n//                 useLoginState\r\n//==============================================//\r\nconst useLoginState = () => {\r\n    // recuperation de notre state grace au consumer\r\n    const context = React.useContext(loginStateContext);\r\n    if(context === undefined)\r\n        throw new Error(\"le State doit s'utiliser dans un provider\")\r\n\r\n    return context;\r\n}\r\n\r\n// =============================================//\r\n//                 useLoginDispatchState\r\n//==============================================//\r\nconst useLoginDispatchState = () => {\r\n    // recuperation de notre fonction dispatch grace au consumer\r\n    const context = React.useContext(loginDispatchContext);\r\n    if(context === undefined)\r\n        throw new Error(\" la fonction dispatch doit s'utilsier dans le provider\")\r\n    return context;\r\n}\r\n\r\n// =============================================//\r\n//                 Order fonctions\r\n//==============================================//\r\n// LOGIN FONCTION IMPLEMENTATION\r\nconst login = async (dispatch, myState) => {\r\n    const requestBody = {\r\n        query: `\r\n            query{\r\n                login(email: , password: ){ userId email admin token tokenExpiration }\r\n            }\r\n        `\r\n    }\r\n\r\n    const results = await fetch('http://localhost:8000/graphql', {\r\n        method: \"POST\",\r\n        body: JSON.stringify(requestBody),\r\n        headers:{\r\n            'Content-type': 'application/json'\r\n            \r\n        }\r\n    })\r\n    if(results.status !==  201 && results.status !== 200){\r\n        throw new Error(\"erreur de Login ...\" + results.statusText);\r\n    }\r\n    const {data} =  await results.json();\r\n\r\n    dispatch({type: \"LOGIN\" , payload: data.login })\r\n}\r\n\r\nconst logout = (dispatch) => {\r\n    dispatch({type: \"LOGOUT \" , payload: { token: '', userId: '', userEmail: '', tokenExpiration: ''}});\r\n}\r\n// =============================================//\r\n//                MODULES iMPORTS               //\r\n\r\nexport {\r\n    useLoginDispatchState,\r\n    useLoginState,\r\n    LoginProvider,\r\n    login,\r\n    logout\r\n}"]},"metadata":{},"sourceType":"module"}